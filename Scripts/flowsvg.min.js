/* flowSVG - v0.1.0 - 2015-03-08*/
/*global SVG, console, window, document, jQuery*/
var flowSVG=function(){"use strict";function a(a){N=a,O=void 0!==N.interactive?N.interactive:!0,U=void 0!==N.showButtons?N.showButtons:!0,V=void 0!==N.scrollto?N.scrollto:!0}function b(){var a=N.w||180,b=N.h||140,c=N.arrowColour||"grey",d="rgb(66, 66, 66)",e="#fff",f="rgb(51, 51, 51)",g=N.defaultFontSize||12,h={showButtons:N.showButtons||!0,minOpacity:N.minOpacity||0,maxOpacity:N.maxOpacity||1,btnBarHeight:N.btnBarHeight||40,btnBarSelectedColour:N.btnBarSelectedColour||"black",btnBarHoverColour:N.btnBarHoverColour||"dimgrey",btnBarFontSize:N.btnBarFontSize||g,btnBarRadius:N.btnBarRadius||10,shapeWidth:N.shapeWidth||a,shapeHeight:N.shapeHeight||b,connectorLength:N.connectorLength||80,startWidth:N.startWidth||a,startHeight:N.startHeight||40,startCornerRadius:N.startCornerRadius||20,startFill:N.startFill||c,startStrokeWidth:N.startStrokeWidth||.1,startStrokeColour:N.startStrokeColour||"rgb(66, 66, 66)",startTextColour:N.startTextColour||e,startText:N.startText||"Start",startFontSize:N.startFontSize||g,decisionWidth:N.decisionWidth||N.w||a,decisionHeight:N.decisionHeight||N.h||b,decisionFill:N.decisionFill||"#8b3572",decisionTextColour:N.decisionTextColour||e,decisionFontSize:N.decisionFontSize||g,finishTextColour:N.finishTextColour||e,finishWidth:N.finishWidth||a,finishHeight:N.finishHeight||b,finishLeftMargin:N.finishLeftMargin||20,finishFill:N.finishFill||"#0F6C7E",finishFontSize:N.finishFontSize||g,finishLinkColour:N.finishLinkColour||"yellow",processWidth:N.processWidth||a,processHeight:N.processHeight||b,processLeftMargin:N.processLeftMargin||20,processFill:N.processFill||"#fff",processStrokeColour:N.processStrokeColour||d,processStrokeWidth:N.processStrokeWidth||.1,processTextColour:N.processTextColour||f,processFontSize:N.processFontSize||g,processLinkColour:N.processLinkColour||"darkblue",labelWidth:N.labelWidth||30,labelHeight:N.labelHeight||20,labelRadius:N.labelRadius||5,labelStroke:N.labelStroke||.1,labelFill:N.labelFill||c,labelOpacity:N.labelOpacity||1,labelFontSize:N.labelFontSize||g,labelTextColour:N.labelTextColour||e,arrowHeadHeight:N.arrowHeadHeight||20,arrowHeadColor:N.arrowHeadColor||c,arrowHeadOpacity:N.arrowHeadOpacity||1,connectorStrokeWidth:N.connectorStrokeWidth||1.5,connectorStrokeColour:N.connectorStrokeColour||c,tipStrokeColour:N.tipStrokeColour||d,tipStrokeWidth:N.tipStrokeWidth||.1,tipFill:N.tipFill||"#fff",tipFontSize:N.tipFontSize||g,tipMarginTop:N.tipMarginTop||10,tipMarginLeft:N.tipMarginLeft||10};return h}function c(a){for(H=a,F=0;F<H.length;F+=1)R[H[F].label]=F}function d(a){var b="0,0 "+G.arrowHeadHeight+",0 "+G.arrowHeadHeight/2+","+G.arrowHeadHeight,c=a.polygon(b).fill({color:G.arrowHeadColor,opacity:G.arrowHeadOpacity}).cx(G.arrowHeadHeight/2).cy(G.arrowHeadHeight/2);return c}function e(){var a=C.group(),b=d(a).move(-(G.arrowHeadHeight/2),G.connectorLength-G.arrowHeadHeight),c=C.line(0,0,0,G.connectorLength-G.arrowHeadHeight).attr({"stroke-width":G.connectorStrokeWidth,stroke:G.connectorStrokeColour});return a.add(c).add(b),a}function f(a,b){var c,d=b.group(),e=d.rect(G.labelWidth,G.labelHeight).radius(G.labelRadius).stroke({width:G.labelStroke}).attr({opacity:G.labelOpacity,fill:G.labelFill});return e.move(-(G.labelWidth/2),G.labelHeight/2),c=d.text(a).attr({fill:G.labelTextColour,"text-anchor":"middle","font-size":G.labelFontSize}),c.cy(e.cy()),d}function g(a){var b,c,d=I.group(),e="0,"+G.decisionHeight/2+" "+G.decisionWidth/2+",0 "+G.decisionWidth+","+G.decisionHeight/2+" "+G.decisionWidth/2+","+G.decisionHeight;return b=d.polygon(e).attr({fill:G.decisionFill,"class":"fc-rhombus"}),d.attr("class","fc-decision"),c=d.text(function(b){a.text.forEach(function(a){b.tspan(a).newLine().attr("text-anchor","middle")})}),c.fill(G.decisionTextColour).font({size:G.decisionFontSize}),c.cx(b.cx()+c.bbox().width+c.bbox().x),c.cy(b.cy()),d}function h(a){var b,c,d,e=I.group().attr({"class":"finish-group"}),f=e.rect(G.finishWidth,G.finishHeight).attr({fill:G.finishFill,"class":"fc-finish"}).radius(20),g=e.group();return g.text(function(b){a.text.forEach(function(a){b.tspan(a).newLine()})}).fill(G.finishTextColour).font({size:G.finishFontSize}),a.links&&a.links.forEach(function(a){var b,c=C.link(a.url),d=C.text(a.text);c.add(d),a.target&&c.target(a.target),d.fill(G.finishLinkColour).font({size:G.finishFontSize}),b=g.bbox(),d.dmove(0,b.height+5),g.add(c)}),a.tip&&(b=e.text(a.tip.title).fill(G.finishLinkColour).font({size:G.finishFontSize}).attr("cursor","pointer"),b.move(G.finishLeftMargin,f.height()-25),b.on("mouseover",function(){c=e.group(),d=e.text(function(b){a.tip.text.forEach(function(a){b.tspan(a).newLine()})}).font({size:G.tipFontSize}).move(G.tipMarginLeft,G.tipMarginTop);var b=c.rect(G.shapeWidth-G.finishLeftMargin,d.bbox().height+2*G.tipMarginTop).attr({fill:G.tipFill,stroke:G.tipStrokeColour,"class":"fc-tip"});c.add(d),c.x(G.finishLeftMargin/2),c.y(this.getAttribute("y")-b.height())}).on("mouseout",function(){c.remove()})),g.move(G.finishLeftMargin,(f.height()-g.bbox().height)/2-5),e}function i(a){var b=I.group().attr({"class":"process-group"}),c=b.rect(G.processWidth,G.processHeight).attr({fill:G.processFill,stroke:G.processStrokeColour,"class":"fc-process"}),d=b.group();return d.text(function(b){a.text.forEach(function(a){b.tspan(a).newLine()})}).font({size:G.processFontSize}),a.links&&a.links.forEach(function(a){var b,c=C.link(a.url),e=C.text(a.text);c.add(e),a.target&&c.target(a.target),e.fill(G.processLinkColour).font({size:G.processFontSize}),b=d.bbox(),e.dmove(0,b.height+5),d.add(c)}),d.move(G.finishLeftMargin,(c.height()-d.bbox().height)/2-5),b}function j(a){var b,c,d,f,g=C.group().attr({"class":"fc-start"});return d=g.rect(G.startWidth,G.startHeight).attr({fill:G.startFill,"stroke-width":G.startStrokeWidth,stroke:G.startStrokeWidth}).radius(G.startCornerRadius),L=g.attr("id"),D=e(),b=g.text(function(a){a.tspan(G.startText).newLine().attr({"text-anchor":"middle","font-size":G.startFontSize,fill:G.startTextColour})}),c=d.bbox(),D.move(c.cx,c.height),b.move(c.cx),b.cy(c.cy),g.add(D),O===!0&&(g.attr({cursor:"pointer"}),g.click(function(){var b=a[0].svgid;if(a[0].show===!1)a[0].show=!0,b.animate().opacity(G.maxOpacity),b.attr("visibility","visible");else{for(b.animate().opacity(G.minOpacity),b.attr("visibility","hidden"),a[0].show=!1,f=0;f<T.length;f+=1)a[R[T[f]]].svgid.animate().opacity(G.minOpacity),a[R[T[f]]].show=!1,a[R[T[f]]].attr("visibility","hidden");T.splice(0,T.length-1)}})),g}function k(a){C=a,I=C.group()}function l(){C.clear(),O=!1,k(C),J(H)}function m(){C.clear(),O=!0,k(C),J(H)}function n(){var a,b,c,d=C.group().attr({cursor:"pointer"}),e=(G.startWidth-5)/2,f=d.rect(e,G.btnBarHeight).fill(G.startFill).radius(G.btnBarRadius);return d.text("Interactive").attr({fill:G.startTextColour,"font-size":G.btnBarFontSize,"pointer-events":"none"}).cy(G.btnBarHeight/2).cx(e/2),a=d.rect(e,G.btnBarHeight).fill(G.startFill).radius(G.btnBarRadius).move(e+5,0),d.text("Static").attr({fill:G.startTextColour,"font-size":G.btnBarFontSize,"pointer-events":"none"}).cy(G.btnBarHeight/2).cx(1.5*e+5),O===!0&&f.fill(G.btnBarSelectedColour),O===!1&&a.fill(G.btnBarSelectedColour),b=f.attr("fill"),c=a.attr("fill"),f.on("mouseover",function(){f.fill({color:G.btnBarHoverColour})}).on("mouseout",function(){f.fill({color:b})}).on("click",function(){O=!0,f.fill(G.btnBarSelectedColour),a.fill(G.startFill),m()}).on("mousedown",function(){f.fill(G.btnBarSelectedColour)}),a.on("mouseover",function(){a.fill({color:G.btnBarHoverColour})}).on("mouseout",function(){a.fill({color:c})}).on("click",function(){O=!1,a.fill(G.btnBarSelectedColour),f.fill(G.startFill),l()}).on("mousedown",function(){a.fill(G.btnBarSelectedColour)}),d}function o(a,b){if(!a.type||"function"!=typeof E[a.type])return console.log(a.type+" is not a valid shape."),!1;var c=E[a.type](a);a.id=c.attr("id"),a.svgid=c,a.svgshape=c.get(0),P[a.label]=a.id,Q[a.id]=b,O===!1?(a.show=!0,c.opacity(G.maxOpacity)):(a.show=!1,c.attr("visibility","hidden"),c.opacity(G.minOpacity))}function p(a){a.yes&&(a.yesid=P[a.yes],a.svgyesid=SVG.get(P[a.yes])),a.no&&(a.noid=P[a.no],a.svgnoid=SVG.get(P[a.no])),a.next&&(a.nextid=P[a.next],a.svgnextid=SVG.get(P[a.next]))}function q(a){var b;a.orient||(a.orient={yes:"b",no:"r",next:"b"}),a.yes&&(b=R[a.yes],H[b]&&(H[b].previd=a.id,H[b].prev=a.label,H[b].svgprevid=SVG.get(a.id),"b"===a.orient.yes&&(H[b].isBelow=a.id,H[b].svgisBelow=SVG.get(a.id)),"r"===a.orient.yes&&(H[b].isRightOf=a.id,H[b].svgisRightOf=SVG.get(a.id)))),a.no&&(b=R[a.no],H[b]&&(H[b].previd=a.id,H[b].prev=a.label,H[b].svgprevid=SVG.get(a.id),"b"===a.orient.no&&(H[b].isBelow=a.id,H[b].svgisBelow=SVG.get(a.id)),"r"===a.orient.no&&(H[b].isRightOf=a.id,H[b].svgisRightOf=SVG.get(a.id)))),a.next&&(b=R[a.next],H[b]&&(H[b].previd=a.id,H[b].prev=a.label,H[b].svgprevid=SVG.get(a.id),"b"===a.orient.next&&(H[b].isBelow=a.id,H[b].svgisBelow=SVG.get(a.id)),"r"===a.orient.next&&(H[b].isRightOf=a.id,H[b].svgisRightOf=SVG.get(a.id))))}function r(a,b){var c,d,e=a.svgid;0===b&&(a.isBelow=L),!a.inNode&&a.isBelow&&(a.inNode="t"),!a.inNode&&a.isRightOf&&(a.inNode="l"),a.isBelow&&(0===b?e.move(0,0):(d=a.svgisBelow,e.move(d.x(),d.y()+d.bbox().height+G.connectorLength))),a.isRightOf&&(c=O===!1&&void 0!==a.moveRight?a.moveRight:G.connectorLength,d=a.svgisRightOf,e.move(d.x()+d.bbox().width+c,d.y()))}function s(a){var b,c;for(b=a;b<T.length;b+=1)c=H[R[T[b]]],c.show=!1,c.svgid.animate().opacity(G.minOpacity),c.svgid.attr("visibility","hidden");T.splice(a,T.length)}function t(a){var b,c,d=a.svgid,e=I.group();a.yes&&void 0!==a.yesid&&(b=a.svgyesid,c=H[R[a.yes]],"t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"b"===a.orient.yes&&(a.yesOutPos=[d.cx(),d.cy()+d.get(0).cy()],c.inNode=void 0!==c.inNode?c.inNode:"t","l"===c.inNode&&(c.inNodePos=[b.x()-G.arrowHeadHeight,b.cy()])),"r"===a.orient.yes&&(a.yesOutPos=[d.x()+d.get(0).width(),d.cy()],c.inNode=void 0!==c.inNode?c.inNode:"l","l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.yesid)),a.no&&void 0!==a.noid&&(c=H[R[a.no]],b=a.svgnoid,"b"===a.orient.no&&(a.noOutPos=[d.cx(),d.cy()+d.get(0).cy()],c.inNode=void 0!==c.inNode?c.inNode:"t",c.inNodePos=[b.cx(),b.y()]),"r"===a.orient.no&&(a.noOutPos=[d.cx()+d.get(0).cx(),d.cy()],c.inNode=void 0!==c.inNode?c.inNode:"l","t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.noid)),a.next&&(c=H[R[a.next]],"b"===a.orient.next&&(a.nextOutPos=[d.cx(),d.cy()+d.get(0).cy()],c.inNode=void 0!==c.inNode?c.inNode:"t","t"===c.inNode&&(b=a.svgnextid,c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(b=a.svgnoid,c.inNodePos=[b.x(),b.cy()])),"r"===a.orient.next&&(a.nextOutPos=[d.x()+d.get(0).width(),d.y()+d.get(0).cy()],c.inNode=void 0!==c.inNode?c.inNode:"l",b=a.svgnextid,"t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.nextid)),e.back(),a.conngroup=e}function u(a){var b,c,d=a.svgshape;a.yes&&void 0!==a.yesid&&(b=H[R[a.yes]].svgshape,c=H[R[a.yes]],"t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"b"===a.orient.yes&&(a.yesOutPos=[d.cx(),d.y()+d.bbox().height],c.inNode=void 0!==c.inNode?c.inNode:"t","l"===c.inNode&&(c.inNodePos=[b.x()-G.arrowHeadHeight,b.cy()])),"r"===a.orient.yes&&(a.yesOutPos=[d.x()+d.width(),d.cy()],c.inNode=void 0!==c.inNode?c.inNode:"l","l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.yesid)),a.no&&void 0!==a.noid&&(c=H[R[a.no]],b=H[R[a.no]].svgshape,"b"===a.orient.no&&(a.noOutPos=[d.cx(),d.y()+d.bbox().height],c.inNode=void 0!==c.inNode?c.inNode:"t",c.inNodePos=[b.cx(),b.y()]),"r"===a.orient.no&&(a.noOutPos=[d.x()+d.bbox().width,d.cy()],c.inNode=void 0!==c.inNode?c.inNode:"l","t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.noid)),a.next&&(c=H[R[a.next]],"b"===a.orient.next&&(a.nextOutPos=[d.cx(),d.bbox().height+d.y()],c.inNode=void 0!==c.inNode?c.inNode:"t","t"===c.inNode&&(b=H[R[a.next]].svgshape,c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(b=a.svgnoid,c.inNodePos=[b.x(),b.cy()])),"r"===a.orient.next&&(a.nextOutPos=[d.x()+d.bbox().width,d.cy()],c.inNode=void 0!==c.inNode?c.inNode:"l",b=H[R[a.next]].svgshape,"t"===c.inNode&&(c.inNodePos=[b.cx(),b.y()]),"l"===c.inNode&&(c.inNodePos=[b.x(),b.cy()])),S.push(a.nextid))}function v(a){var b,c=a.svgid;a.yes&&void 0!==a.yesid&&(b=f("Yes",c),a.yesBtn=b,b.attr("cursor","pointer"),b.on("click",function(){M(a,"yes")}),"b"===a.orient.yes&&b.move(a.yesOutPos[0],a.yesOutPos[1]),"r"===a.orient.yes&&b.move(a.yesOutPos[0]+20,a.yesOutPos[1]-20)),a.no&&void 0!==a.noid&&(b=f("No",c),a.noBtn=b,b.attr("cursor","pointer"),b.on("click",function(){M(a,"no")}),"b"===a.orient.no&&b.move(a.noOutPos[0],a.noOutPos[1]),"r"===a.orient.no&&b.move(a.noOutPos[0]+20,a.noOutPos[1]-20))}function w(a){var b,c=a.conngroup;a.yes&&void 0!==a.yesid&&(b=f("Yes",c),"b"===a.orient.yes&&b.move(a.yesOutPos[0],a.yesOutPos[1]),"r"===a.orient.yes&&b.move(a.yesOutPos[0]+20,a.yesOutPos[1]-20)),a.no&&void 0!==a.noid&&(b=f("No",c),"b"===a.orient.no&&b.move(a.noOutPos[0],a.noOutPos[1]),"r"===a.orient.no&&b.move(a.noOutPos[0]+20,a.noOutPos[1]-20))}function x(a){var b,c,e,f,g,h=a.svgid;c=a.svgshape.x()+a.svgshape.bbox().width+G.connectorLength-G.arrowHeadHeight,e=a.svgshape.cy()-G.arrowHeadHeight/2,f=a.svgshape.cx()-G.arrowHeadHeight/2,g=a.svgshape.y()+a.svgshape.bbox().height+G.connectorLength-G.arrowHeadHeight,void 0!==a.svgyesid&&("r"===a.orient.yes&&(b=d(h),b.move(c,e),b.rotate(270)),"b"===a.orient.yes&&(b=d(h),b.move(f,g))),void 0!==a.svgnoid&&("r"===a.orient.no&&(b=d(h),b.move(c,e),b.rotate(270)),"b"===a.orient.no&&(b=d(h),b.move(f,g))),void 0!==a.svgnextid&&("r"===a.orient.next&&(b=d(h),b.move(c,e),b.rotate(270)),"b"===a.orient.next&&(b=d(h),b.move(f,g)))}function y(a){var b,c,e=a.conngroup;a.yes&&void 0!==a.yesid&&(b=d(e),c=H[R[a.yes]],"b"===a.orient.yes&&(b.move(c.inNodePos[0]-G.arrowHeadHeight/2,c.inNodePos[1]-G.arrowHeadHeight),"l"===c.inNode&&b.rotate(270)),"r"===a.orient.yes&&(b.move(c.inNodePos[0]-G.arrowHeadHeight/2,c.inNodePos[1]-G.arrowHeadHeight),"l"===c.inNode&&(b.move(c.inNodePos[0]-G.arrowHeadHeight,c.inNodePos[1]-G.arrowHeadHeight/2),b.rotate(270)))),a.no&&void 0!==a.noid&&(b=d(e),c=H[R[a.no]],"b"===a.orient.no&&b.move(c.inNodePos[0]-G.arrowHeadHeight/2,c.inNodePos[1]-G.arrowHeadHeight),"r"===a.orient.no&&(b.move(c.inNodePos[0]-G.arrowHeadHeight,c.inNodePos[1]-G.arrowHeadHeight/2),b.rotate(270))),a.next&&void 0!==a.nextid&&(b=d(e),c=H[R[a.next]],"b"===a.orient.next&&(b.move(c.inNodePos[0]-G.arrowHeadHeight/2,c.inNodePos[1]-G.arrowHeadHeight),"l"===c.inNode&&b.rotate(270)),"r"===a.orient.next&&(b.move(c.inNodePos[0]-G.arrowHeadHeight,c.inNodePos[1]-G.arrowHeadHeight/2),b.rotate(270)))}function z(a,b,c){var d,e,f,g,h,i,j=c.svgshape,k=2*G.arrowHeadHeight;return a[1]===j.y()+j.height()?(d=a,e=[a[0],a[1]+k],b[1]>a[1]&&(e=[a[0],b[1]-k],f=[b[0],b[1]-k]),b[0]<a[0]&&(f=[b[0],b[1]-k]),b[1]<=a[1]&&(f=[b[0],b[1]+k]),i=[b[0],b[1]-G.arrowHeadHeight],[d,e,f,i]):a[0]<b[0]&&a[1]>b[1]?(d=a,e=[a[0]+k,a[1]],f=[a[0]+k,b[1]-k],g=[b[0],b[1]-k],i=[b[0],b[1]-G.arrowHeadHeight],[d,e,f,g,i]):a[0]>b[0]&&a[1]<b[1]?(d=a,e=[a[0]+k,a[1]],f=[a[0]+k,b[1]-G.shapeHeight/2-k],g=[b[0]-k,b[1]-G.shapeHeight/2-k],h=[b[0]-k,b[1]],i=[b[0],b[1]-G.arrowHeadHeight],[d,e,f,g,h,i]):a[0]<b[0]&&a[1]<b[1]?(d=a,e=[a[0],a[1]+k],f=[b[0],a[1]+k],i=[b[0],b[1]-G.arrowHeadHeight],[d,e,f,i]):(a[1]<b[1]?i=[b[0],b[1]-G.arrowHeadHeight]:a[0]<b[0]&&(i=[b[0]-G.arrowHeadHeight,b[1]]),[a,i])}function A(a){var b,c;a.yesid&&(b=a.yesOutPos,"b"===a.orient.yes&&(c=[b[0],b[1]+G.connectorLength]),"r"===a.orient.yes&&(c=[b[0]+G.connectorLength,b[1]]),a.svgid.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none")),a.noid&&(b=a.noOutPos,"b"===a.orient.no&&(c=[b[0],b[1]+G.connectorLength]),"r"===a.orient.no&&(c=[b[0]+G.connectorLength,b[1]]),a.svgid.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none")),a.nextid&&(b=a.nextOutPos,"b"===a.orient.next&&(c=[b[0],b[1]+G.connectorLength]),"r"===a.orient.next&&(c=[b[0]+G.connectorLength,b[1]]),void 0===c&&(c=H[R[a.next]].yesOutPos),a.svgid.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none"))}function B(a){var b,c;a.yesid&&(b=a.yesOutPos,c=H[R[a.yes]].inNodePos,a.conngroup.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none")),a.noid&&(b=a.noOutPos,c=H[R[a.no]].inNodePos,a.conngroup.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none")),a.nextid&&(b=a.nextOutPos,c=H[R[a.next]].inNodePos,void 0===c&&(c=H[R[a.next]].yesOutPos),a.conngroup.polyline(z(b,c,a)).stroke({width:G.connectorStrokeWidth,color:G.connectorStrokeColour}).fill("none"))}var C,D,E,F,G,H,I,J,K,L,M,N={},O=!0,P={},Q={},R={},S=[],T=[],U=!0,V=!0;return E={decision:g,finish:h,process:i},M=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if("yes"===b){if(H[R[a.yes]].show===!0&&H[R[a.no]].show===!1)return d=T.indexOf(a.yes),s(d),void(e=a.id);d=T.indexOf(a.no),d>-1&&s(d),-1===T.indexOf(a.yes)&&T.push(a.yes),"b"===a.orient.yes&&(a.svgyesid.move(a.svgid.x(),a.svgid.y()+a.svgid.bbox().height),void 0!==H[R[a.yes]].svgnextid&&H[R[a.yes]].svgnextid.move(a.svgyesid.x(),a.svgyesid.bbox().y+a.svgyesid.bbox().height)),"r"===a.orient.yes&&(a.svgyesid.move(a.svgid.x()+a.svgid.bbox().width,a.svgid.y()),void 0!==H[R[a.yes]].svgnextid&&H[R[a.yes]].svgnextid.move(a.svgyesid.x(),a.svgyesid.bbox().y+a.svgyesid.bbox().height)),a.svgyesid.animate().opacity(G.maxOpacity),e=a.yesid,a.svgyesid.attr("visibility","visible"),H[R[a.yes]].show=!0,H[R[a.no]].svgid.animate().opacity(G.minOpacity),H[R[a.no]].svgid.attr("visibility","hidden"),H[R[a.no]].show=!1,void 0!==H[R[a.yes]].next&&(c=H[R[a.yes]].next,T.push(c),H[R[c]].svgid.animate().opacity(G.maxOpacity),H[R[c]].svgid.attr("visibility","visible"),H[R[c]].show=!0,e=H[R[c]].id)}if("no"===b){if(H[R[a.no]].show===!0)return d=T.indexOf(a.no),s(d),void(e=a.id);d=T.indexOf(a.yes),d>-1&&s(d),-1===T.indexOf(a.no)&&T.push(a.no),"b"===a.orient.no&&(a.svgnoid.move(a.svgid.x(),a.svgid.y()+a.svgid.bbox().height),void 0!==H[R[a.no]].svgnextid&&H[R[a.no]].svgnextid.move(a.svgnoid.x(),a.svgnoid.bbox().y+a.svgnoid.bbox().height)),"r"===a.orient.no&&(a.svgnoid.move(a.svgid.x()+a.svgid.bbox().width,a.svgid.y()),void 0!==H[R[a.no]].svgnextid&&H[R[a.no]].svgnextid.move(a.svgnoid.x(),a.svgnoid.bbox().y+a.svgnoid.bbox().height)),a.svgnoid.animate().opacity(G.maxOpacity),e=a.noid,a.svgnoid.attr("visibility","visible"),H[R[a.no]].show=!0,void 0!==H[R[a.no]].next&&(c=H[R[a.no]].next,T.push(c),H[R[c]].show=!0,H[R[c]].svgid.animate().opacity(G.maxOpacity),H[R[c]].svgid.attr("visibility","visible"),e=H[R[c]].id)}V===!0&&(f=window.innerHeight,g=C.attr("id"),h=document.getElementById(g),i=document.getElementById(e),j=SVG.get(e).bbox(),k=h.createSVGPoint(),l=i.getCTM(),m=k.matrixTransform(l).y+j.height+h.parentNode.offsetTop+20,m>f&&(window.jQuery&&window.jQuery.scrollTo?jQuery.scrollTo(m-f,1e3):window.scrollTo(0,m-f)))},J=function(a){H=a;var d;G=b(),U===!0&&(d=n()),K=j(H),void 0!==d&&K.y(d.bbox().height+10),I.y(K.y()+K.bbox().height),H.forEach(o),H.forEach(p),c(H),H.forEach(q),H.forEach(r),O===!0&&(H.forEach(u),H.forEach(A),H.forEach(v),H.forEach(x)),O===!1&&(H.forEach(t),H.forEach(B),H.forEach(w),H.forEach(y))},{config:a,draw:k,shapes:J}}();